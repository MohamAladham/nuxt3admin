<script setup lang="ts">import {USER_DEFAULT_AVATAR} from "@/constants";const config = useRuntimeConfig();const mounted = ref(false);const filter = ref({});const route = useRoute();const router = useRouter();const search = ref(route.query.search);const page = ref(route.query.page);const prepareRequestQuery = () => {  let queryObj = {...route.query, ...filter.value}  if (!queryObj) return ''  let query = '?';  Object.entries(queryObj).forEach((value, index) => {    query += index === 0 ? '' : '&';    query += `${value[0]}=${value[1]}`;  });  // update url  router.push({    path: route.path,    query: queryObj  });  return query;}const {data: items, pending, refresh: refreshItems, error} =    await useFetch(() => config.public.apiBase + '/users' + prepareRequestQuery());const itemURL = `/admin/users/`;watch(search, (newVariant, oldVariant) => {  if (newVariant !== oldVariant) {    let v = {'page': 1, 'search': newVariant};    filter.value = {...filter.value, ...v};    refreshItems();  }})watch(page, (newVariant, oldVariant) => {  let v = {'page': newVariant};  filter.value = {...filter.value, ...v};  refreshItems();})onMounted(() => {  mounted.value = true;});definePageMeta({  layout: "admin",});</script><template>  <div>    <teleport to="header #header_buttons" v-if="mounted">      <AdminUIButton to="/admin/users/create" icon="bi bi-plus">        Add New      </AdminUIButton>      <AdminUIButton color="secondary" icon="bi bi-box-arrow-right">        Export      </AdminUIButton>    </teleport>    <AdminUITableSearch v-model:search="search"/>    <AdminUITable v-if="items" :titles="[{text:'User Name'}, {text:'Email'}, {text:'Manage', colWidth:2}]">      <AdminUITableRow v-for="item in items.data">        <AdminUITableCol textAlign="left">          <NuxtLink :href="itemURL+item.id">            <img :src="item.photo?item.photo:USER_DEFAULT_AVATAR" class="rounded-circle" style="width:40px; height: 40px; margin-left: 3px"/>            {{ item.name }}          </NuxtLink>        </AdminUITableCol>        <AdminUITableCol>          {{ item.email }}        </AdminUITableCol>        <AdminUITableCol :colWidth="2">          <AdminUIButton color="secondary" :to="itemURL+item.id">            Edit          </AdminUIButton>          <AdminUIButton color="danger">            Delete          </AdminUIButton>        </AdminUITableCol>      </AdminUITableRow>    </AdminUITable>    <AdminUIPaginate v-if="items.data?.length && items.meta.total > items.meta.per_page"                     :items="items"                     v-model:page="page"/>  </div></template>